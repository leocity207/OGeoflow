digraph  {
	graph [compound=true   newrank=true]
	rankdir="LR"
	splines=ortho
	subgraph {
		rank=same
		START_ARRAY [shape=circle label="StartArray()"]
		SWITCH_STATE [shape=box label="Current_State()"]
		
		PROPERTIES_SUB_ARRAY [shape=diamond]
		PROPERTIES_SUB_KEY [shape=diamond]
		FOREIGN_KEY [shape=diamond]
		FOREIGN_ARRAY [shape=diamond]
		FEATURE_COLLECTION [shape=diamond]
		GEOMETRY_COLLECTION [shape=diamond]
		BBOX [shape=diamond]
		COORDINATES [shape=diamond]

		START_ARRAY -> SWITCH_STATE -> PROPERTIES_SUB_ARRAY;
		PROPERTIES_SUB_ARRAY -> PROPERTIES_SUB_KEY -> FOREIGN_KEY -> FOREIGN_ARRAY ->  COORDINATES -> BBOX -> FEATURE_COLLECTION -> GEOMETRY_COLLECTION -> FALSE [arrowhead=dot dir=both]
	}

	subgraph {
		rank=same
		PUSH_ARRAY_IN_PROPERTY_ARRAY [shape=box label="Push Array in Property array"]
		PUSH_ARRAY_IN_PROPERTY_KEY [shape=box label="Reset state to array \n push key value in property"]
		RESET_FOREIGN_KEY [shape=box label="Reset_State(FOREIGN_OBJECT)"]
		PUSH_FOREIGN_ARRAY [shape=box label="Push_State(FOREIGN_OBJECT)"]
		PUSH_COORDIANTE [shape=box label="clear position \n level++ \n max_level = max(max_level, level)"]
	}

	TRUE  [shape=circle label="True"]
	subgraph {
		FALSE [shape=circle label="False"]
		FALSE_NOTE [shape=none, label="UNEXPECTED_STATE_OBJECT"];
		FALSE -> FALSE_NOTE [style=invis]
		rank=same
	}

	PROPERTIES_SUB_ARRAY -> PUSH_ARRAY_IN_PROPERTY_ARRAY
	PROPERTIES_SUB_KEY   -> PUSH_ARRAY_IN_PROPERTY_KEY
	FOREIGN_KEY          -> RESET_FOREIGN_KEY
	FOREIGN_ARRAY        -> PUSH_FOREIGN_ARRAY
	COORDINATES          -> PUSH_COORDIANTE

	{PUSH_ARRAY_IN_PROPERTY_ARRAY PUSH_ARRAY_IN_PROPERTY_KEY RESET_FOREIGN_KEY PUSH_FOREIGN_ARRAY  PUSH_COORDIANTE BBOX FEATURE_COLLECTION GEOMETRY_COLLECTION} -> TRUE


}